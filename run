echo "üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ Word-Cards..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ Docker
if ! command -v docker &> /dev/null; then
    echo "‚ùå Docker –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker —Å–Ω–∞—á–∞–ª–∞."
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–ø—É—â–µ–Ω –ª–∏ LibreTranslate
if ! docker-compose ps | grep -q "libretranslate.*Up"; then
    echo "üì¶ –ó–∞–ø—É—Å–∫–∞–µ–º LibreTranslate..."
    docker-compose up -d libretranslate
    echo "‚è≥ –ñ–¥–µ–º –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ –ø–µ—Ä–µ–≤–æ–¥–∞..."
    sleep 10  # –î–∞–µ–º –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
else
    echo "‚úÖ LibreTranslate —É–∂–µ –∑–∞–ø—É—â–µ–Ω"
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Å–µ—Ä–≤–∏—Å –ø–µ—Ä–µ–≤–æ–¥–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É –ø–µ—Ä–µ–≤–æ–¥–∞..."
response=$(curl -s -X POST "http://localhost:5000/translate" \
  -H "Content-Type: application/json" \
  -d '{"q":"–ø—Ä–∏–≤–µ—Ç", "source":"ru", "target":"en", "format":"text"}' || echo "error")

if [[ $response == *"error"* ]] || [[ $response != *"hello"* ]]; then
    echo "‚ö†Ô∏è  –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤. –ñ–¥–µ–º –µ—â–µ..."
    sleep 10
fi

echo "ü§ñ –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞..."
cd "$(dirname "$0")"  # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å–∫—Ä–∏–ø—Ç–∞
go run ./cmd/bot